<div class="container" id="page-toshow">
    <div class="row" style="justify-content: right;">
        <button type="button" class="close" matTooltip="סגירה" aria-label="Close" (click)="closeModal()">
            <span>&times;</span>
        </button>
    </div>

    <div dir="rtl" class="row reportHeader" *ngIf="asDialog">
        <h1>{{Dept_Name}}</h1>
    </div>
    <div dir="rtl" class="row reportHeader" *ngIf="asDialog">
        <div class="col-4">

        </div>
        <div class="col-4">
            <h2><b>{{firstname}} {{lastname}}</b></h2>
        </div>
        <div class="col-4">
            <h6><b>{{gender}} {{dob}}</b></h6>
        </div>
    </div>
    <div dir="rtl" class="row reportHeader" *ngIf="asDialog">
        <h3><b>{{description}} {{corona}}</b></h3>
    </div>

    <div id="page-toshow" class="padding-top-0">
        <form dir="rtl" class="form col" id="formBody" [formGroup]="ReportGroup"
            *ngIf="caseNumber != '' || reportType == 'administrative'"
            [style.background]="AdminNurse == '1' ? 'floralwhite':  'aliceblue'">
            <div class="modal-header text-right">
                <div class="row mt-3">
                    <div class="col-4 text-center">{{date2}}
                    </div>
                    <div class="col-4 text-center" style="font-size: xx-large;">
                        {{firstName}} {{lastName}}
                    </div>
                    <div class="col-4 text-center">
                        {{time2}}
                    </div>
                </div>
            </div>
            <div class="modal-body">
                <div class="row" *ngIf="reportType == 'clinical'">
                    <div class="col-12">
                        <mat-form-field class="example-full-width" appearance="fill">
                            <mat-label>אבחנה</mat-label>
                            <textarea matInput style="font-family: 'Roboto';font-size: 20px;font-weight: bolder;"
                                formControlName="Diagnosis" placeholder="אבחנה"></textarea>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row" *ngIf="reportType == 'administrative'">
                    <div class="col">
                        <div class="form-group">
                            <mat-form-field>
                                <mat-label>נושא/מחלקה</mat-label>
                                <input type="text" aria-label="department"
                                    style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;" matInput
                                    [formControl]="departmentfilter" [matAutocomplete]="auto2">
                                <mat-autocomplete #auto2="matAutocomplete">
                                    <mat-option *ngFor="let dept of filteredOptions2 | async" [value]="dept.Dept_Name"
                                        style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;">
                                        {{dept.Dept_Name}}
                                    </mat-option>
                                </mat-autocomplete>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="col">
                        <form class="example-form">
                            <mat-form-field class="example-full-width">
                                <mat-label>קטגוריה</mat-label>
                                <input type="text" aria-label="category"
                                    style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;" matInput
                                    [formControl]="categoryfilter" [matAutocomplete]="auto3">
                                <mat-autocomplete autoActiveFirstOption #auto3="matAutocomplete">
                                    <mat-option *ngFor="let cat of filteredOptions3 | async" [value]="cat.Cat_Name"
                                        style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;">
                                        {{cat.Cat_Name}}
                                    </mat-option>
                                </mat-autocomplete>
                            </mat-form-field>
                        </form>
                    </div>
                    <!-- <div class="col">
                        <div class="form-group">
                            <mat-form-field>
                                <mat-label>תת קטגוריה</mat-label>
                                <input type="text" aria-label="subcategory"
                                    style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;" matInput
                                    [formControl]="subcategoryfilter" [matAutocomplete]="auto4">
                                <mat-autocomplete #auto4="matAutocomplete">
                                    <mat-option *ngFor="let subcat of filteredOptions4 | async"
                                        [value]="subcat.SubCat_Name"
                                        style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;">
                                        {{subcat.SubCat_Name}}
                                    </mat-option>
                                </mat-autocomplete>
                            </mat-form-field>
                        </div>
                    </div> -->
                    <div class="col">
                        <div class="form-group">
                            <mat-form-field>
                                <mat-label>סטטוס</mat-label>
                                <mat-select formControlName="ReportStatus"
                                    style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;">
                                    <mat-option *ngFor="let st of status" [value]="st.value"
                                        style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;">
                                        {{st.viewValue}} </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="col-1 text-center">
                        <span class="material-icons"
                            [style.color]="ReportGroup.controls['Important'].value == 'True' ? 'red': 'grey'"
                            (click)="setImportantReport()" matTooltip="סמן כחשוב" id="importantIcon">
                            notification_important
                        </span>
                    </div>
                    <div class="col" style="align-self: center;">
                        <section class="example-section">
                            <mat-checkbox class="example-margin" formControlName="toContinue"
                                (change)="autoDate($event.checked)"
                                style="font-family: 'Roboto';font-weight: bolder;font-size: 20px; text-align: center;">
                                דורש
                                המשך טיפול</mat-checkbox>
                        </section>
                    </div>
                </div>
                <div class="row">
                    <div class="col-3">
                        <div class="form-group">
                            <mat-form-field>
                                <mat-label>משמרת</mat-label>
                                <b style="font-size: 26px;font-family: 'Roboto';font-weight: bolder;font-size: 18px;">
                                    <input matInput class="form-control" formControlName="ReportShift" type="text" />
                                </b>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="col-9">
                        <div class="form-group">
                            <mat-form-field id="reportContentField">
                                <textarea matInput
                                    style="font-size: 15px;font-family: 'Roboto';font-weight: bolder;font-size: 18px;"
                                    rows="3" placeholder="תוכן הדוח" class="form-control border-1"
                                    formControlName="ReportText" required></textarea>
                            </mat-form-field>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer text-left">
                <button matTooltip="דוח חדש" class="btn btn-primary btn-raised ml-3 float-left" id="BtnStyle"
                    (click)="onSubmit('0')" type="submit" mat-raised-button>
                    <span class="material-icons">
                        create_new_folder
                    </span>
                </button>
                <button matTooltip="שמור והמשך דיווח" class="btn btn-primary btn-raised ml-3 float-left" id="BtnStyle"
                    (click)="onSubmit('1')" type="submit" mat-raised-button>
                    <span class="material-icons">
                        save
                    </span>
                </button>
                <br><br><br>
                <!-- <button *ngIf="reportID != '0'" matTooltip="מחיקה" id="BtnStyle" type="button" mat-raised-button
                    class="btn btn-outline-dark ml-3" color="warn" (click)="deleteReport(reportID)">
                    <span class="material-icons">
                        delete
                    </span>
                </button> -->
            </div>
        </form>

        <!-- <div *ngIf="AdminNurse == '1'">
        </div> -->
        <app-fill-report *ngFor="let item of currentItemsToShow" style="font-size: small;" [reportID]="item.reportID"
            [userFullName]="item.userFullName" [ifGeneral]="ifGeneral"></app-fill-report>
        <!-- <div class="card-footer pb-0 pt-3">
                <jw-pagination [items]="items" (changePage)="onChangePage($event)"></jw-pagination>
            </div> -->
        <mat-paginator (page)="onPageChange($event)" [length]="ELEMENT_DATA.length" [pageSize]="5" [pageSizeOptions]="[5, 10]">
        </mat-paginator>
    </div>
    <div class="container-fluid trans-80 mb-2">
        <div class="row search-cont">
            <div class="col">
                <div dir="rtl" class="card w-85-p">
                    <div dir="rtl" class="card-body">
                        <form class="form" [formGroup]="searchReportsGroup">
                            <div class="row">
                                <div class="col-12" *ngIf="reportType == 'clinical'">
                                    <div class="form-group">
                                        <mat-form-field>
                                            <input matInput autocomplete="off" placeholder="שם מטופל"
                                                formControlName="PatientName" />
                                        </mat-form-field>
                                    </div>
                                </div>
                                <!-- <div class="col-6">
                                    <div class="form-group lh-37">
                                        <mat-form-field>
                                            <mat-label>משמרת</mat-label>
                                            <mat-select formControlName="ReportShift">
                                                <mat-option [value]="''">הכל</mat-option>
                                                <mat-option *ngFor="let sh of shift" [value]="sh.value">
                                                    {{sh.viewValue}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                </div> -->
                                <div class="col-4" *ngIf="reportType == 'administrative'">
                                    <div class="form-group lh-37">
                                        <mat-form-field>
                                            <mat-label>מחלקה</mat-label>
                                            <input type="text" aria-label="department" name="departmentfilter"
                                                style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;"
                                                matInput [formControl]="departmentfilter" [matAutocomplete]="auto2">
                                            <mat-autocomplete #auto2="matAutocomplete">
                                                <mat-option *ngFor="let dept of filteredOptions2 | async"
                                                    [value]="dept.Dept_Name"
                                                    style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;">
                                                    {{dept.Dept_Name}}
                                                </mat-option>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="col-4" *ngIf="reportType == 'administrative'">
                                    <div class="form-group lh-37">
                                        <mat-form-field>
                                            <mat-label>קטגוריה</mat-label>
                                            <input type="text" aria-label="category"
                                                style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;"
                                                matInput [formControl]="categoryfilter2" [matAutocomplete]="auto3">
                                            <mat-autocomplete #auto3="matAutocomplete">
                                                <mat-option *ngFor="let cat of filteredOptions3_2 | async"
                                                    [value]="cat.Cat_Name"
                                                    style="font-family: 'Roboto';font-weight: bolder;font-size: 18px;">
                                                    {{cat.Cat_Name}}
                                                </mat-option>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="col-4" *ngIf="reportType == 'administrative'">
                                    <div class="form-group lh-37">
                                        <mat-form-field>
                                            <mat-label>קטיגוריה אדומה</mat-label>
                                            <mat-select formControlName="ImportantCategory">
                                                <mat-option [value]="'הכל'">הכל</mat-option>
                                                <mat-option *ngFor="let st of importantCat" [value]="st.value"
                                                    [style.color]="st.value == '1' ? 'red':  'darkgrey'">
                                                    {{st.viewValue}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div [ngClass]="reportType == 'administrative' ? 'col-4' : 'col-6'">
                                    <div class="form-group">
                                        <mat-form-field>
                                            <input matInput formControlName="ReportStartDate" (focus)="startdate.open()"
                                                autocomplete="off" placeholder="מ תאריך" name="startdate"
                                                [matDatepicker]="startdate" />
                                            <mat-datepicker-toggle matSuffix [for]="startdate"></mat-datepicker-toggle>
                                            <mat-datepicker #startdate></mat-datepicker>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div [ngClass]="reportType == 'administrative' ? 'col-4' : 'col-6'">
                                    <div class="form-group">
                                        <mat-form-field>
                                            <input matInput formControlName="ReportEndDate" (focus)="enddate.open()"
                                                autocomplete="off" placeholder="עד תאריך " required name="enddate"
                                                [matDatepicker]="enddate" />
                                            <mat-datepicker-toggle matSuffix [for]="enddate"></mat-datepicker-toggle>
                                            <mat-datepicker #enddate></mat-datepicker>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="col-4" *ngIf="reportType == 'administrative'">
                                    <div class="form-group lh-37">
                                        <mat-form-field>
                                            <mat-label>סטטוס</mat-label>
                                            <mat-select formControlName="ReportStatus">
                                                <mat-option [value]="'הכל'">הכל</mat-option>
                                                <mat-option *ngFor="let st of status" [value]="st.value"
                                                    [style.color]="st.value == 'טופל' ? 'darkseagreen':  'darkgrey'">
                                                    {{st.viewValue}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                            <button matTooltip="חיפוש" mat-raised-button type="submit"
                                class="btn btn-primary btn-raised" (click)="searchReports()">
                                <span class="material-icons">
                                    search
                                </span>
                            </button>
                            &nbsp;&nbsp;
                            <button matTooltip="הדפסה" mat-raised-button type="button"
                                class="btn btn-primary btn-raised" (click)="print()">
                                <span class="material-icons">
                                    local_printshop
                                </span>
                            </button>
                            &nbsp;&nbsp;
                            <button matTooltip="שליחה לנמען" mat-raised-button type="button"
                                class="btn btn-primary btn-raised" (click)="openShareDialog()">
                                <span class="material-icons">
                                    reply
                                </span>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="d-none-desktop" #printmycontent style="direction: rtl;">
    <div class="row" style="text-align: center;">
        <h2 *ngIf="reportType == 'clinical'">דווח קליני</h2>
        <h2 *ngIf="reportType == 'administrative'">דווח ניהולי</h2>
    </div>
    <div class="row text-right" *ngFor="let tblRow of ELEMENT_DATA"
        style="border-style: outset;margin-bottom: 20px;padding: 6px;">
        <div class="col-12" style="width: 100%;direction: rtl;">
            <div class="row" style="width: 100%;">
                <div class="col-md-4">
                    <b>תאריך שעה:</b>
                    {{
                    tblRow.LastUpdatedDate
                    }}
                </div>
                <div class="col-md-4">
                    <b>נושא/מחלקה:</b>
                    {{ tblRow.ReportMachlol }}
                </div>
                <div class="col-md-4" *ngIf="tblRow.Important == 'True'">
                    <b [ngStyle]="{color: tblRow.Important == 'True' ? 'red' : ''}">קטיגוריה אדומה</b>
                </div>
                <div class="col-md-4">
                    <b>משמרת:</b>
                    {{
                    tblRow.ReportShift
                    }}
                </div>
                <div class="col-md-4">
                    <b>מדווח:</b>
                    {{
                    tblRow.userFullName
                    }}
                </div>
                <div class="col-md-4" *ngIf="reportType == 'clinical'">
                    <b>שם מטופל:</b>
                    {{
                    tblRow.PatientName
                    }}
                </div>
            </div>
            <div class="row" *ngIf="tblRow.ReportText != ''" style="border-top: 1px dashed grey;margin-top: 12px;">
                <div class="col-12">
                    <h5><b>תוכן הדווח :</b></h5>
                    <p class="">
                        {{ tblRow.ReportText }}
                    </p>
                </div>
            </div>
            <div class="row" *ngFor="let reply of tblRow.ReportsReplyList">
                <div class="col-12">
                    <h5><b>תגובות לדווח :</b></h5>
                    <div class="row">
                        {{reply.FirstName}} {{reply.LastName}} - {{reply.MessageDate}} {{reply.MessageTime}}
                    </div>
                    <div class="row">
                        <p class="text-right" style="font-family: 'math';font-weight: bolder;font-size: 18px;">
                            {{reply.ResponseText}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>