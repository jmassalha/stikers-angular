<button type="button" class="close" matTooltip="סגירה" aria-label="Close" (click)="closeModal()">
    <span aria-hidden="true">&times;</span>
</button>
<div dir="rtl" class="row reportHeader" *ngIf="asDialog">
    <h1>{{Dept_Name}}</h1>
</div>
<div dir="rtl" class="row reportHeader" *ngIf="asDialog">
    <div class="col-4">
        
    </div>
    <div class="col-4">
        <h2><b>{{firstname}} {{lastname}}</b></h2>
    </div>
    <div class="col-4">
        <h6><b>{{gender}} {{dob}}</b></h6>
    </div>
</div>
<div dir="rtl" class="row reportHeader" *ngIf="asDialog">
    <h3><b>{{description}} {{corona}}</b></h3>
</div>

<div id="page-toshow" class="padding-top-0">
    <form dir="rtl" class="form col" id="formBody" [formGroup]="ReportGroup">
        <div class="modal-header text-right">
            <div class="row mt-3">
                <div class="col-4 text-center">{{date2}}
                </div>
                <div class="col-4 text-center" style="font-size: xx-large;">
                    {{firstName}} {{lastName}}
                </div>
                <div class="col-4 text-center">
                    {{time2}}
                </div>
            </div>
        </div>
        <div class="modal-body">
            <div class="row" *ngIf="reportType == 'clinical'">
                <div class="col-12">
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>אבחנה</mat-label>
                        <textarea matInput style="font-family: 'Roboto';font-size: 15px;" formControlName="Diagnosis"
                            placeholder="אבחנה"></textarea>
                    </mat-form-field>
                </div>
            </div>
            <div class="row" *ngIf="reportType == 'administrative'">
                <div class="col">
                    <div class="form-group">
                        <mat-form-field>
                            <mat-label>נושא/מחלקה</mat-label>
                            <input type="text" aria-label="department" style="font-family: 'Roboto';" matInput
                                [formControl]="departmentfilter" [matAutocomplete]="auto2">
                            <mat-autocomplete #auto2="matAutocomplete">
                                <mat-option *ngFor="let dept of filteredOptions2 | async" [value]="dept.Dept_Name"
                                    style="font-family: 'Roboto';">
                                    {{dept.Dept_Name}}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <mat-form-field>
                            <mat-label>קטגוריה</mat-label>
                            <input type="text" aria-label="category" style="font-family: 'Roboto';" matInput
                                [formControl]="categoryfilter" [matAutocomplete]="auto3">
                            <mat-autocomplete #auto3="matAutocomplete">
                                <mat-option *ngFor="let cat of filteredOptions3 | async" [value]="cat.Cat_Name"
                                    style="font-family: 'Roboto';">
                                    {{cat.Cat_Name}}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <mat-form-field>
                            <mat-label>תת קטגוריה</mat-label>
                            <input type="text" aria-label="subcategory" style="font-family: 'Roboto';" matInput
                                [formControl]="subcategoryfilter" [matAutocomplete]="auto4">
                            <mat-autocomplete #auto4="matAutocomplete">
                                <mat-option *ngFor="let subcat of filteredOptions4 | async" [value]="subcat.SubCat_Name"
                                    style="font-family: 'Roboto';">
                                    {{subcat.SubCat_Name}}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <mat-form-field>
                            <mat-label>סטטוס</mat-label>
                            <mat-select formControlName="ReportStatus" style="font-family: 'Roboto';">
                                <mat-option *ngFor="let st of status" [value]="st.value" style="font-family: 'Roboto';">
                                    {{st.viewValue}} </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
                <div class="col" style="align-self: center;">
                    <section class="example-section">
                        <mat-checkbox class="example-margin" formControlName="toContinue"
                            (change)="autoDate($event.checked)" style="font-family: 'Roboto';">דורש
                            המשך טיפול</mat-checkbox>
                    </section>
                </div>
            </div>
            <div class="row">
                <div class="col-3">
                    <div class="form-group">
                        <mat-form-field>
                            <mat-label>משמרת</mat-label>
                            <b style="font-size: 26px;font-family: 'Roboto';">
                                <input matInput class="form-control" formControlName="ReportShift" type="text" />
                            </b>
                        </mat-form-field>
                    </div>
                </div>
                <div class="col-9">
                    <div class="form-group">
                        <mat-form-field>
                            <textarea matInput style="font-size: 15px;font-family: 'Roboto';" rows="3"
                                placeholder="תוכן הדוח" class="form-control border-1"
                                formControlName="ReportText"></textarea>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer text-left">
            <button matTooltip="שמירה" class="btn btn-primary btn-raised ml-3 float-left" id="BtnStyle"
                (click)="onSubmit()" type="submit" mat-raised-button>
                <span class="material-icons">
                    save
                </span>
            </button>
            <button *ngIf="reportID != '0'" matTooltip="מחיקה" id="BtnStyle" type="button" mat-raised-button
                class="btn btn-outline-dark ml-3" color="warn" (click)="deleteReport(reportID)">
                <span class="material-icons">
                    delete
                </span>
            </button>
        </div>
    </form>

    <app-fill-report *ngFor="let item of ELEMENT_DATA" style="font-size: small;" [reportID]="item.reportID"
        [userFullName]="item.userFullName"></app-fill-report>

</div>
<div class="container-fluid trans-80 mb-2">
    <div class="row search-cont">
        <div class="col">
            <div dir="rtl" class="card w-85-p">
                <div dir="rtl" class="card-body">
                    <form class="form" [formGroup]="searchReportsGroup">
                        <div class="row">
                            <!-- <div class="col-12">
                                <div class="form-group">
                                    <mat-form-field>
                                        <input matInput autocomplete="off" placeholder="מספר מקרה"
                                            formControlName="CaseNumber" />
                                    </mat-form-field>
                                </div>
                            </div> -->
                            <div class="col-6">
                                <div class="form-group lh-37">
                                    <mat-form-field>
                                        <mat-label>משמרת</mat-label>
                                        <mat-select formControlName="ReportShift">
                                            <mat-option [value]="''">הכל</mat-option>
                                            <mat-option *ngFor="let sh of shift" [value]="sh.value">
                                                {{sh.viewValue}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
                            <!-- <div class="col-4">
                                <div class="form-group lh-37">
                                    <mat-form-field>
                                        <mat-label>מחלקה</mat-label>
                                        <input type="text" aria-label="department" matInput
                                            [formControl]="departmentfilter" [matAutocomplete]="auto2">
                                        <mat-autocomplete #auto2="matAutocomplete">
                                            <mat-option *ngFor="let dept of filteredOptions2 | async"
                                                [value]="dept.Dept_Name">
                                                {{dept.Dept_Name}}
                                            </mat-option>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </div>
                            </div> -->
                            <div class="col-6">
                                <div class="form-group lh-37">
                                    <mat-form-field>
                                        <mat-label>קטגוריה</mat-label>
                                        <mat-select formControlName="ReportCategory">
                                            <mat-option [value]="''">הכל</mat-option>
                                            <mat-option *ngFor="let cat of all_categories_filter"
                                                [value]="cat.Cat_Name">
                                                {{cat.Cat_Name}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-4">
                                <div class="form-group">
                                    <mat-form-field>
                                        <input matInput formControlName="ReportStartDate" (focus)="startdate.open()"
                                            autocomplete="off" placeholder="מ תאריך" name="startdate"
                                            [matDatepicker]="startdate" />
                                        <mat-datepicker-toggle matSuffix [for]="startdate"></mat-datepicker-toggle>
                                        <mat-datepicker #startdate></mat-datepicker>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="form-group">
                                    <mat-form-field>
                                        <input matInput formControlName="ReportEndDate" (focus)="enddate.open()"
                                            autocomplete="off" placeholder="עד תאריך " required name="enddate"
                                            [matDatepicker]="enddate" />
                                        <mat-datepicker-toggle matSuffix [for]="enddate"></mat-datepicker-toggle>
                                        <mat-datepicker #enddate></mat-datepicker>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="form-group lh-37">
                                    <mat-form-field>
                                        <mat-label>סטטוס</mat-label>
                                        <mat-select formControlName="ReportStatus">
                                            <mat-option [value]="''">הכל</mat-option>
                                            <mat-option *ngFor="let st of status" [value]="st.value"
                                                [style.color]="st.value == 'טופל' ? 'darkseagreen':  'darkgrey'">
                                                {{st.viewValue}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                        <button matTooltip="חיפוש" mat-raised-button type="submit" class="btn btn-primary btn-raised"
                            (click)="searchReports()">
                            <span class="material-icons">
                                search
                            </span>
                        </button>
                        &nbsp;&nbsp;
                        <button matTooltip="הדפסה" mat-raised-button type="button" class="btn btn-primary btn-raised"
                            (click)="print()">
                            <span class="material-icons">
                                local_printshop
                            </span>
                        </button>
                        &nbsp;&nbsp;
                        <button matTooltip="שליחה לנמען" mat-raised-button type="button"
                            class="btn btn-primary btn-raised" (click)="openShareDialog()">
                            <span class="material-icons">
                                reply
                            </span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>