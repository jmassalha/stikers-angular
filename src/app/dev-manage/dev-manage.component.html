<!-- <img src="https://balko.co.il/wp-content/uploads/2020/02/under-construction-.jpg"
    width="100%" height="100%"> -->
<div class="container" dir="rtl" *ngIf="!permission">
    <form dir="rtl" class="form col" [formGroup]="permissionPassword">
        <div class="row">
            <div class="col-12 bedsUpdate">
                <h2>כניסה לדף ניהול</h2>
                <div class="row">
                    <div class="col-4">
                    </div>
                    <div class="col-4">
                        <div class="form-group">
                            <mat-form-field>
                                <input matInput formControlName="passwordLogin" autocomplete="off" type="password"
                                    placeholder="הקלד סיסמה לכניסה" name="fliterVal" />
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="col-4">
                        <button matTooltip="אישור" mat-raised-button type="submit"
                            class="btn btn-primary btn-raised float-right" (click)="checkPassword()">
                            <span class="material-icons">
                                done
                            </span>
                        </button>
                    </div>
                    <div class="col-4">
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<div *ngIf="permission">
    <div class="container" dir="rtl">
        <form dir="rtl" class="form col" [formGroup]="changeUser">
            <div class="row">
                <div class="col-12 bedsUpdate">
                    <h2>שינוי שם משתמש</h2>
                    <div class="row">
                        <div class="col-12">
                            <div class="form-group">
                                <mat-form-field>
                                    <mat-label>החלפה למשתמש חדש</mat-label>
                                    <input type="text" aria-label="user"
                                        style="font-family: 'math';font-weight: bolder;font-size: 18px;" matInput
                                        [formControl]="userfilter" [matAutocomplete]="auto2">
                                    <mat-autocomplete #auto2="matAutocomplete">
                                        <mat-option *ngFor="let user of filteredOptions2 | async"
                                            [value]="user.firstname"
                                            style="font-family: 'math';font-weight: bolder;font-size: 18px;">
                                            {{user.firstname}}
                                        </mat-option>
                                    </mat-autocomplete>
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="container pb-5" dir="rtl">
        <form dir="rtl" class="form col">
            <div class="row">
                <div class="col-12 bedsUpdate">
                    <h2>הרשאות למערכת אחיות</h2>
                    <div class="row">
                        <div dir="rtl" class="container text-center">
                            <table mat-table [dataSource]="dataSource" #mytable class="my-table mat-elevation-z8">

                                <ng-container matColumnDef="user">
                                    <th mat-header-cell *matHeaderCellDef> משתמש עובד </th>
                                    <td mat-cell *matCellDef="let element"> {{element.UserName}} </td>
                                </ng-container>

                                <ng-container matColumnDef="pc1">
                                    <th mat-header-cell *matHeaderCellDef> הרשאה למחשב 1 </th>
                                    <td mat-cell *matCellDef="let element"> {{element.IpAddress}} </td>
                                </ng-container>

                                <ng-container matColumnDef="pc2">
                                    <th mat-header-cell *matHeaderCellDef> הרשאה למחשב 2 </th>
                                    <td mat-cell *matCellDef="let element"> {{element.IpAddress2}} </td>
                                </ng-container>

                                <ng-container matColumnDef="pc3">
                                    <th mat-header-cell *matHeaderCellDef> הרשאה למחשב 3 </th>
                                    <td mat-cell *matCellDef="let element"> {{element.IpAddress3}} </td>
                                </ng-container>

                                <ng-container matColumnDef="pc4">
                                    <th mat-header-cell *matHeaderCellDef> הרשאה למחשב 4 </th>
                                    <td mat-cell *matCellDef="let element"> {{element.IpAddress4}} </td>
                                </ng-container>

                                <ng-container matColumnDef="pc5">
                                    <th mat-header-cell *matHeaderCellDef> הרשאה למחשב 5 </th>
                                    <td mat-cell *matCellDef="let element"> {{element.IpAddress5}} </td>
                                </ng-container>

                                <ng-container matColumnDef="pc6">
                                    <th mat-header-cell *matHeaderCellDef> הרשאה למחשב 6 </th>
                                    <td mat-cell *matCellDef="let element"> {{element.IpAddress6}} </td>
                                </ng-container>

                                <ng-container matColumnDef="pc7">
                                    <th mat-header-cell *matHeaderCellDef> הרשאה למחשב 7 </th>
                                    <td mat-cell *matCellDef="let element"> {{element.IpAddress7}} </td>
                                </ng-container>

                                <ng-container matColumnDef="tablet">
                                    <th mat-header-cell *matHeaderCellDef> הרשאה לטאבלט </th>
                                    <td mat-cell *matCellDef="let element"> {{element.TabletAddress}} </td>
                                </ng-container>

                                <ng-container matColumnDef="change">
                                    <th mat-header-cell *matHeaderCellDef> עדכון </th>
                                    <td mat-cell *matCellDef="let element"> <button
                                            (click)="updateUserPermission(element)"><a
                                                style="color: blue">עדכן</a></button>
                                    </td>
                                </ng-container>
                                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<ng-template #modalContent let-close="close">
    <h1 mat-dialog-title style="text-align: center;">דיווח תקלה</h1>
    <hr>
    <form mat-dialog-content dir="rtl" style="text-align: right;">
        <p>{{UserNameUpdate}}</p>
        <mat-form-field class="example-full-width">
            <mat-label>מחשב 1:</mat-label>
            <input matInput [(ngModel)]="IpAddress" [ngModelOptions]="{standalone: true}" />
        </mat-form-field>
        <mat-form-field class="example-full-width">
            <mat-label>מחשב 2:</mat-label>
            <input matInput [(ngModel)]="IpAddress2" [ngModelOptions]="{standalone: true}" />
        </mat-form-field>
        <mat-form-field class="example-full-width">
            <mat-label>מחשב 3:</mat-label>
            <input matInput [(ngModel)]="IpAddress3" [ngModelOptions]="{standalone: true}" />
        </mat-form-field>
        <mat-form-field class="example-full-width">
            <mat-label>מחשב 4:</mat-label>
            <input matInput [(ngModel)]="IpAddress4" [ngModelOptions]="{standalone: true}" />
        </mat-form-field>
        <mat-form-field class="example-full-width">
            <mat-label>מחשב 5:</mat-label>
            <input matInput [(ngModel)]="IpAddress5" [ngModelOptions]="{standalone: true}" />
        </mat-form-field>
        <mat-form-field class="example-full-width">
            <mat-label>מחשב 6:</mat-label>
            <input matInput [(ngModel)]="IpAddress6" [ngModelOptions]="{standalone: true}" />
        </mat-form-field>
        <mat-form-field class="example-full-width">
            <mat-label>מחשב 7:</mat-label>
            <input matInput [(ngModel)]="IpAddress7" [ngModelOptions]="{standalone: true}" />
        </mat-form-field>
        <mat-form-field class="example-full-width">
            <mat-label>טאבלט:</mat-label>
            <input matInput [(ngModel)]="TabletAddress" [ngModelOptions]="{standalone: true}" />
        </mat-form-field>

    </form>
    <div mat-dialog-actions>
        <button mat-button mat-dialog-close>ביטול</button>
        <button mat-raised-button color="primary" mat-dialog-close (click)="submitUpdate()">בצע</button>
    </div>
</ng-template>
<div class="container pb-5" dir="rtl" *ngIf="permission">
    <form dir="rtl" class="form col">
        <div class="row">
            <div class="col-12 bedsUpdate">
                <h2>chatGpt</h2>
                <div class="row">
                    <div class="col-6">
                        <a target="_blank"
                            href="https://auth0.openai.com/u/signup/identifier?state=hKFo2SBQWm5lSTlFMk5HR0VCSGRuYjJuRnlIVmVkNDlEUnhlR6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIHR1RGw1VExqRnFsbkxrS3F1ZXpselhmSW9FaXYtVS1ho2NpZNkgRFJpdnNubTJNdTQyVDNLT3BxZHR3QjNOWXZpSFl6d0Q">להשיג
                            טוקין</a>
                        <div class="form-group">
                            <mat-form-field>
                                <mat-label>הכנס טוקין אישי</mat-label>
                                <input matInput type="text" [(ngModel)]="chatGptToken"
                                    [ngModelOptions]="{standalone: true}"
                                    style="font-family: 'math';font-weight: bolder;font-size: 18px;" />
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <mat-form-field appearance="fill">
                                <mat-label>בחר מודל</mat-label>
                                <mat-select [(ngModel)]="modelSelection" [ngModelOptions]="{standalone: true}">
                                    <mat-option value="completions">
                                        completions
                                    </mat-option>
                                    <mat-option value="moderations">
                                        moderations
                                    </mat-option>
                                    <mat-option value="images/generations">
                                        images/generations
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div class="form-group">
                            <mat-form-field>
                                <mat-label>הכנס שאלה</mat-label>
                                <textarea matInput type="text" [(ngModel)]="chatGpt"
                                    [ngModelOptions]="{standalone: true}"
                                    style="font-family: 'math';font-weight: bolder;font-size: 18px;"></textarea>
                            </mat-form-field>
                        </div>
                    </div>
                    <button (click)="chooseModel()"><a style="color: blue">שאל</a></button>
                </div>
                <div class="row">
                    <mat-progress-bar mode="indeterminate" *ngIf="loadingGpt"></mat-progress-bar>
                    <div class="col-12" *ngFor="let answer of chatGptAnswerlist">
                        תשובה: <br>
                        <p style="white-space: pre-line" *ngIf="!loadingGpt">{{answer}}</p>
                        <img *ngIf="modelSelection == 'images/generations'" src="{{answer[0].url}}" />
                        <img *ngIf="modelSelection == 'images/generations'" src="{{answer[1].url}}" />
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>