<mat-card class="form-amen">
  <form dir="rtl" [formGroup]="caseNumberForm" autocomplete="off" *ngIf="withCaseNumber">
    <!-- <zxing-scanner [torch]="torchEnabled" [device]="deviceCurrent" (deviceChange)="onDeviceChange($event)" (scanSuccess)="onCodeResult($event)"
    [formats]="formatsEnabled" [tryHarder]="tryHarder" (permissionResponse)="onHasPermission($event)"
    (camerasFound)="onCamerasFound($event)" (torchCompatible)="onTorchCompatible($event)"></zxing-scanner> -->
    <mat-form-field class="full-width">
      <input formControlName="CaseNumber" matInput placeholder="מספר מקרה">
    </mat-form-field>
    <button mat-raised-button type="submit" (click)="searchCaseNumber()" class="btn btn-primary btn-raised mb-2">
      <span class="material-icons">
        done
      </span>
    </button>
  </form>

  <form dir="rtl" [formGroup]="surveyForm" (ngSubmit)="onSubmit()" autocomplete="off" *ngIf="!withCaseNumber">

    <mat-card class="full-width text-center">
      <label>{{_formName}}</label>
    </mat-card>

    <div class="survey-options w-100100 float-right">
      <div class="poll-options">
        <div class="row">
          <div class="d-block">
            <div class="full-width mt-3 mb-3" style="white-space: pre-wrap;text-align-last: right;text-align: right;">
              {{_formOpenText}}
            </div>
          </div>
        </div>
        <ol formArrayName="Answers" class="list-style">
          <div class="row">
            <li
              [ngClass]="{'col-md-12 col-xs-12 col-sm-12': questionCtrl.QuestionType == 'TextArea', ' col-md-6 col-xs-12 col-sm-6' : questionCtrl.QuestionType != 'TextArea' }"
              *ngFor="let questionCtrl of _questionArr; let i=index">
              <div class="d-block" *ngIf="questionCtrl.QuestionType == 'TextArea'">
                <div class="full-width mt-3 mb-3"
                  style="white-space: pre-wrap;text-align-last: right;text-align: right;">
                  {{questionCtrl.QuestionValue}}
                </div>
              </div>
              <mat-card [formGroupName]="i" class="d-block" *ngIf="questionCtrl.QuestionType != 'TextArea'">
                <span class="pos-me-number-li">{{ i + 1}} . </span>
                <div class="row">
                  <div class="col-12 text-right">
                    <label
                      style="white-space: pre-wrap;text-align-last: right;text-align: right;">{{questionCtrl.QuestionValue}}</label>
                  </div>
                  <div class="col-12 text-right">
                    <div class="d-block" *ngIf="questionCtrl.QuestionType == 'RadioButton'">
                      <mat-radio-group class="example-radio-group" formControlName="answerContent">
                        <div class="d-block" *ngFor="let optionCtrl of _optionArr let j = index">
                          <div class="d-block" *ngIf="optionCtrl.QuestionIDFK == questionCtrl.QuestionID">
                            <mat-radio-button style="float: right;" value="{{optionCtrl.OptionValue}}">
                              {{optionCtrl.OptionValue}}</mat-radio-button>
                          </div>
                        </div>
                      </mat-radio-group>
                    </div>
                    <div class="d-block" *ngIf="questionCtrl.QuestionType == 'CheckBox'">
                      <mat-radio-group>
                        <div class="d-block" *ngFor="let optionCtrl of _optionArr let k = index">
                          <div class="d-block" *ngIf="optionCtrl.QuestionIDFK == questionCtrl.QuestionID">
                            <mat-checkbox class="example-margin" style="float: right;" formControlName="answerContent"
                              (change)="myModel($event,optionCtrl.OptionValue,questionCtrl.QuestionID)">
                              {{optionCtrl.OptionValue}}</mat-checkbox>
                          </div>
                        </div>
                      </mat-radio-group>
                    </div>
                    <div class="d-block" *ngIf="questionCtrl.QuestionType == 'Text'">
                      <mat-form-field class="full-width">
                        <input matInput formControlName="answerContent" type="text">
                      </mat-form-field>
                    </div>

                    <div class="d-block" *ngIf="questionCtrl.QuestionType == 'Date'">
                      <mat-form-field appearance="fill">
                        <mat-label>אפשרות תאריך</mat-label>
                        <input matInput [max]="maxDate | date:'yyyy-MM-dd'" formControlName="answerContent"
                          [matDatepicker]="picker">

                      </mat-form-field>
                      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                      <mat-datepicker #picker></mat-datepicker>
                    </div>
                    <div class="d-block" *ngIf="questionCtrl.QuestionType == 'Time'">
                      <mat-form-field>
                        <input matInput [ngxTimepicker]="endTime" [format]="24" formControlName="answerContent" />
                      </mat-form-field>
                      <ngx-material-timepicker #endTime></ngx-material-timepicker>
                    </div>
                    <div class="d-block" *ngIf="questionCtrl.QuestionType == 'Email'">
                      <mat-form-field class="full-width">
                        <input formControlName="answerContent" matInput type="email">
                      </mat-form-field>
                    </div>
                    <div class="d-block" *ngIf="questionCtrl.QuestionType == 'Phone'">
                      <mat-form-field class="full-width">
                        <input formControlName="answerContent" matInput>
                      </mat-form-field>
                    </div>
                    <div class="d-block" *ngIf="questionCtrl.QuestionType == 'ID'">

                    </div>
                    <div class="d-block" *ngIf="questionCtrl.QuestionType == 'Signature'">
                      <mat-form-field class="full-width">
                        <input formControlName="answerContent" matInput>
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </mat-card>
            </li>
          </div>
        </ol>
      </div>
    </div>
    <div class="full-width mb-2">
      <div class="row" style="text-align: right;">חתימה</div>
      <canvas class="row" #canvas id="canvas"></canvas>
      <button mat-raised-button color="secondary" style="float: right;" type="button" (click)="resetSign()"><span>תיקון
          חתימה</span></button>
    </div>

    <div class="button-row">
      <button class="full-width mb-5" style="font-weight: bold;font-size: 20px;color: white;" color="primary"
        type="submit" mat-raised-button>
        <span>שליחת שאלון</span>
      </button>
    </div>
  </form>
</mat-card>